% Pandoc Template for Book of Verse
% Simplified template using built-in fonts
\documentclass[11pt,openright,twoside]{book}

%% ============================================================
%% PAGE GEOMETRY - 7" x 10" Technical Book Format
%% ============================================================
\usepackage[
    paperwidth=7in,
    paperheight=10in,
    inner=0.875in,
    outer=0.75in,
    top=0.875in,
    bottom=1in,
    headheight=14pt,
    headsep=0.25in,
    footskip=0.4in
]{geometry}

%% ============================================================
%% FONTS - Using Latin Modern (built into TeX)
%% ============================================================
\usepackage{fontspec}
\setmainfont{Latin Modern Roman}
\setsansfont{Latin Modern Sans}
\setmonofont{Latin Modern Mono}[Scale=0.85]

%% ============================================================
%% COLORS
%% ============================================================
\usepackage{xcolor}

\definecolor{verseblue}{RGB}{30, 90, 160}
\definecolor{verseorange}{RGB}{255, 87, 34}
\definecolor{versegray}{RGB}{60, 60, 65}
\definecolor{codebg}{RGB}{245, 245, 245}
\definecolor{warningbg}{RGB}{255, 243, 224}
\definecolor{warningborder}{RGB}{255, 152, 0}
\definecolor{notebg}{RGB}{227, 242, 253}
\definecolor{noteborder}{RGB}{33, 150, 243}
\definecolor{tipbg}{RGB}{232, 245, 233}
\definecolor{tipborder}{RGB}{76, 175, 80}
\definecolor{dangerbg}{RGB}{255, 235, 238}
\definecolor{dangerborder}{RGB}{244, 67, 54}
\definecolor{shadecolor}{RGB}{245, 245, 245}

%% ============================================================
%% HEADERS AND FOOTERS
%% ============================================================
\usepackage{fancyhdr}
\usepackage{titlesec}

\pagestyle{fancy}
\fancyhf{}
\fancyhead[LE]{\small\textit{\nouppercase{\leftmark}}}
\fancyhead[RO]{\small\textit{\nouppercase{\rightmark}}}
\fancyfoot[LE,RO]{\thepage}

\fancypagestyle{plain}{
    \fancyhf{}
    \fancyfoot[C]{\thepage}
    \renewcommand{\headrulewidth}{0pt}
}

\renewcommand{\headrulewidth}{0.4pt}
\renewcommand{\footrulewidth}{0pt}

%% ============================================================
%% CHAPTER STYLING
%% ============================================================
\titleformat{\part}[display]
    {\centering\Huge\bfseries\sffamily\color{versegray}}
    {\partname\ \thepart}
    {20pt}
    {\Huge}

\titleformat{\chapter}[display]
    {\normalfont\huge\bfseries\sffamily\color{versegray}}
    {\chaptertitlename\ \thechapter}
    {20pt}
    {\Huge}

\titleformat{\section}
    {\normalfont\Large\bfseries\sffamily\color{versegray}}
    {\thesection}
    {1em}
    {}

\titleformat{\subsection}
    {\normalfont\large\bfseries\sffamily\color{versegray}}
    {\thesubsection}
    {1em}
    {}

\titleformat{\subsubsection}
    {\normalfont\normalsize\bfseries\sffamily}
    {\thesubsubsection}
    {1em}
    {}

%% ============================================================
%% ADMONITION BOXES
%% ============================================================
\usepackage{tcolorbox}
\tcbuselibrary{skins,breakable}

\newtcolorbox{warningbox}{
    colback=warningbg, colframe=warningborder,
    boxrule=0pt, leftrule=4pt, arc=0pt, outer arc=0pt,
    left=8pt, right=8pt, top=8pt, bottom=8pt, breakable,
}

\newtcolorbox{notebox}{
    colback=notebg, colframe=noteborder,
    boxrule=0pt, leftrule=4pt, arc=0pt, outer arc=0pt,
    left=8pt, right=8pt, top=8pt, bottom=8pt, breakable,
}

\newtcolorbox{tipbox}{
    colback=tipbg, colframe=tipborder,
    boxrule=0pt, leftrule=4pt, arc=0pt, outer arc=0pt,
    left=8pt, right=8pt, top=8pt, bottom=8pt, breakable,
}

\newtcolorbox{dangerbox}{
    colback=dangerbg, colframe=dangerborder,
    boxrule=0pt, leftrule=4pt, arc=0pt, outer arc=0pt,
    left=8pt, right=8pt, top=8pt, bottom=8pt, breakable,
}

\newtcolorbox{infobox}{
    colback=notebg, colframe=noteborder,
    boxrule=0pt, leftrule=4pt, arc=0pt, outer arc=0pt,
    left=8pt, right=8pt, top=8pt, bottom=8pt, breakable,
}

%% ============================================================
%% TABLES
%% ============================================================
\usepackage{booktabs}
\usepackage{longtable}
\usepackage{array}
\usepackage{multirow}
\usepackage{calc}
\usepackage{etoolbox}
\usepackage{caption}

% Pandoc 3 table support - needs 'none' caption type for uncaptioned tables
\DeclareCaptionLabelFormat{none}{}
\captionsetup[table]{labelformat=none}

% Create a 'none' counter for longtable (Pandoc 3.x requirement)
\newcounter{none}

% Pandoc 3 table width support
\providecommand{\LTcapwidth}{\textwidth}

%% ============================================================
%% HYPERLINKS
%% ============================================================
\usepackage{hyperref}
\hypersetup{
    colorlinks=true,
    linkcolor=verseblue,
    urlcolor=verseblue,
    pdftitle={Book of Verse},
    pdfauthor={Epic Games},
    bookmarksnumbered=true,
}

%% ============================================================
%% MISC
%% ============================================================
\usepackage{graphicx}
\usepackage{float}
\usepackage{enumitem}
\usepackage{microtype}
\usepackage{parskip}
\usepackage{framed}
\usepackage{soul}  % For strikethrough text (\st{})

\widowpenalty=10000
\clubpenalty=10000
\setlist{noitemsep, topsep=0.5em}

%% ============================================================
%% UNICODE FALLBACK FONTS (deferred to avoid microtype conflict)
%% ============================================================
\usepackage{newunicodechar}
\newfontfamily\symbolfont{Segoe UI Symbol}
\newfontfamily\emojifont{Segoe UI Emoji}
\newfontfamily\cjkfont{Yu Gothic}

\AtBeginDocument{
% Check marks and ballot marks
\newunicodechar{‚úì}{{\symbolfont ‚úì}}
\newunicodechar{‚úî}{{\symbolfont ‚úî}}
\newunicodechar{‚úó}{{\symbolfont ‚úó}}
\newunicodechar{‚ùå}{{\emojifont ‚ùå}}
% Warning and other symbols
\newunicodechar{‚ö†}{{\symbolfont ‚ö†}}
% Math and logic symbols
\newunicodechar{‚â†}{{\symbolfont ‚â†}}
\newunicodechar{‚â§}{{\symbolfont ‚â§}}
\newunicodechar{‚äÇ}{{\symbolfont ‚äÇ}}
\newunicodechar{‚äÜ}{{\symbolfont ‚äÜ}}
\newunicodechar{¬±}{{\symbolfont ¬±}}
% Arrows
\newunicodechar{‚Üí}{{\symbolfont ‚Üí}}
% Subscript and superscript digits
\newunicodechar{‚ÇÄ}{{\symbolfont ‚ÇÄ}}
\newunicodechar{‚ÇÅ}{{\symbolfont ‚ÇÅ}}
\newunicodechar{‚ÇÇ}{{\symbolfont ‚ÇÇ}}
\newunicodechar{‚Çô}{{\symbolfont ‚Çô}}
\newunicodechar{¬≥}{{\symbolfont ¬≥}}
% Multiplication and division
\newunicodechar{√ó}{{\symbolfont √ó}}
\newunicodechar{√∑}{{\symbolfont √∑}}
% Greek letters
\newunicodechar{œÄ}{{\symbolfont œÄ}}
% CJK characters
\newunicodechar{Â•Ω}{{\cjkfont Â•Ω}}
% Emoji
\newunicodechar{üòÄ}{{\emojifont üòÄ}}
\newunicodechar{üò∏}{{\emojifont üò∏}}
\newunicodechar{üìö}{{\emojifont üìö}}
\newunicodechar{üêà}{{\emojifont üêà}}
% Variation selector (emoji presentation) - render as nothing
\newunicodechar{Ô∏è}{}
}

%% ============================================================
%% PANDOC COMPATIBILITY
%% ============================================================
\providecommand{\tightlist}{\setlength{\itemsep}{0pt}\setlength{\parskip}{0pt}}

% Pandoc syntax highlighting - let Pandoc define these
$if(highlighting-macros)$
$highlighting-macros$
$endif$

% Only define Shaded if not already defined by highlighting-macros
\makeatletter
\@ifundefined{Shaded}{
    \newenvironment{Shaded}{\begin{snugshade}}{\end{snugshade}}
}{}
\makeatother

%% ============================================================
%% DOCUMENT
%% ============================================================
\begin{document}

\frontmatter

% Half title
\begin{titlepage}
\centering
\vspace*{3in}
{\Huge\sffamily\bfseries Book of Verse}
\vfill
\end{titlepage}

\cleardoublepage

% Full title
\begin{titlepage}
\centering
\vspace*{1.5in}
{\Huge\sffamily\bfseries\color{versegray} Book of Verse}
\vspace{0.5in}
{\Large\itshape The Verse Programming Language}
\vspace{1in}
{\large Documentation by}\\[0.5em]
{\Large Jan Vitek}\\[0.5em]
{\normalsize and the Verse Team}
\vspace{1.5in}
{\large\sffamily Epic Games}
\vfill
{\small\itshape Premium Edition}\\
{\small $date$}
\end{titlepage}

\cleardoublepage

% Copyright
\thispagestyle{empty}
\vspace*{\fill}
\begin{center}
\textbf{Book of Verse}\\[1em]
Documentation for the Verse Programming Language\\[2em]
Copyright \textcopyright\ Epic Games, Inc.\\[1em]
Licensed under CC0-1.0 (Public Domain)\\[2em]
Source: \url{https://github.com/verselang/book}
\end{center}
\vfill
\cleardoublepage

\tableofcontents
\cleardoublepage

\mainmatter

$body$

\backmatter

\cleardoublepage
\thispagestyle{empty}
\vspace*{\fill}
\begin{center}
\textsc{Colophon}\\[2em]
This book was typeset using \LaTeX{} with XeLaTeX.\\[1em]
Page size: 7'' x 10''
\end{center}
\vfill

\end{document}
